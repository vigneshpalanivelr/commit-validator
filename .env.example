# =============================================================================
# Commit Validator - Environment Variables Configuration
# =============================================================================
# Copy this file to .env and configure the values for your environment
# For mrproper container, copy to mrproper.env
# =============================================================================

# -----------------------------------------------------------------------------
# REQUIRED CONFIGURATION
# -----------------------------------------------------------------------------

# GitLab API Access Token (Required)
# Format: glpat-xxxxxxxxxxxxxxxxxxxx
# Scopes: api, read_api (for MR data retrieval and posting comments)
GITLAB_ACCESS_TOKEN=glpat-your-token-here

# -----------------------------------------------------------------------------
# AI/LLM SERVICE CONFIGURATION
# -----------------------------------------------------------------------------
# Choose ONE of the following modes:
# 1. Legacy Mode (direct AI service connection) - uses AI_SERVICE_URL
# 2. New LLM Adapter Mode (BFA integration) - uses BFA_HOST

# --- Legacy Mode (Default if BFA_HOST not set) ---
# Direct connection to AI service without authentication
AI_SERVICE_URL=http://10.31.88.29:6006/generate

# --- New LLM Adapter Mode (Set BFA_HOST to enable) ---
# Hostname for the BFA (Backend Framework Abstraction) service
# When set, requests are routed through BFA with JWT authentication
# Example: api-gateway.internal.com
# BFA_HOST=api-gateway.internal.com

# Pre-configured JWT token for BFA service (optional)
# If set, skips token acquisition API call
# Useful for static token configuration or debugging
# BFA_TOKEN_KEY=

# Timeout in seconds for LLM API calls (default: 120)
# Increase for larger diffs or slower network connections
API_TIMEOUT=120

# -----------------------------------------------------------------------------
# LOGGING CONFIGURATION
# -----------------------------------------------------------------------------

# Base directory for all log files
# Can be mounted as persistent volume (NFS, Docker volume, etc.)
LOG_DIR=/home/docker/tmp/mr-validator-logs

# Logging verbosity level
# Valid values: DEBUG, INFO, WARNING, ERROR, CRITICAL
# DEBUG recommended for troubleshooting
LOG_LEVEL=DEBUG

# Maximum size in bytes for each log file before rotation (default: 50MB)
LOG_MAX_BYTES=52428800

# Number of rotated backup log files to keep
LOG_BACKUP_COUNT=3

# Log directory organization style
# organized: Creates structured directories (date/project/mr)
# flat: All logs in single directory with hostname suffix
LOG_STRUCTURE=organized

# -----------------------------------------------------------------------------
# CONTEXT VARIABLES (Set automatically by webhook server)
# These are typically set dynamically, not in .env file
# Included here for reference and manual testing
# -----------------------------------------------------------------------------

# Unique request identifier for end-to-end tracing
# Format: YYYYMMDD_HHMMSS_XXXXXXXX
# REQUEST_ID=

# Project identifier (path with namespace)
# Example: org/project-name
# PROJECT_ID=

# Merge Request internal ID (within project)
# MR_IID=

# Repository name (decoded from PROJECT_ID)
# MR_REPO=

# Source branch name of the MR
# MR_BRANCH=

# MR author email address
# MR_AUTHOR=

# Latest commit SHA in the MR
# MR_COMMIT=

# MR web URL
# MR_URL=

# Container hostname (used for log file naming in flat structure)
# HOSTNAME=

# -----------------------------------------------------------------------------
# EXAMPLE CONFIGURATIONS
# -----------------------------------------------------------------------------

# Example 1: Production with BFA Integration
# -------------------------------------------
# GITLAB_ACCESS_TOKEN=glpat-xxxxxxxxxxxxxxxxxxxx
# BFA_HOST=api-gateway.internal.com
# API_TIMEOUT=120
# LOG_DIR=/var/log/mr-validator
# LOG_LEVEL=INFO
# LOG_STRUCTURE=organized

# Example 2: Development/Debugging
# ---------------------------------
# GITLAB_ACCESS_TOKEN=glpat-xxxxxxxxxxxxxxxxxxxx
# AI_SERVICE_URL=http://localhost:6006/generate
# LOG_DIR=/tmp/mr-validator-logs
# LOG_LEVEL=DEBUG
# LOG_STRUCTURE=flat

# Example 3: Production with Pre-configured Token
# ------------------------------------------------
# GITLAB_ACCESS_TOKEN=glpat-xxxxxxxxxxxxxxxxxxxx
# BFA_HOST=api-gateway.internal.com
# BFA_TOKEN_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
# API_TIMEOUT=180
# LOG_DIR=/mnt/nfs/mr-validator-logs
# LOG_LEVEL=WARNING
# LOG_STRUCTURE=organized
